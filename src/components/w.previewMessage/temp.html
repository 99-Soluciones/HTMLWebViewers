<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Editor y Copiador de Texto</title>
    <!-- Esto solo es para visual, en Filemaker se seguira usando Style -->
    <!-- <link rel='stylesheet' href='../../../utils/css/close.button.css'> <link rel='stylesheet' href='../css/index.css'> -->
    <!-- Esto sera para Filemaker -->
    <style>
      html,
      body {
        height: 100%;
        margin: 0;
        padding: 0;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Helvetica, Arial, sans-serif;
        background-color: #dcf8c6a2;
      }
      body {
        display: flex;
        flex-direction: column;
        padding: 10px;
        box-sizing: border-box;
      }
      #textEditor {
        width: 100%;
        flex-grow: 1;
        margin-bottom: 15px;
        padding: 10px;
        font-size: 14px;
        border: 1px solid #fff;
        border-radius: 8px;
        box-sizing: border-box;
        resize: vertical;
        background-color: #fff;
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif;
      }
      .controls {
        display: flex;
        align-items: center;
        justify-content: flex-end;
        gap: 12px;
      } /* Base styles for both buttons */
      .controls button {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 50px;
        height: 50px;
        background-color: #25d365;
        border: none;
        border-radius: 50%;
        color: #fff;
        font-weight: bold;
        cursor: pointer;
        overflow: hidden;
        transition: width 0.4s ease, border-radius 0.4s ease, padding 0.4s ease,
          justify-content 0.4s ease;
        padding: 0 12px;
      }
      .controls button svg {
        width: 28px;
        height: 28px;
        flex-shrink: 0;
        display: block;
        transition: margin 0.4s ease;
      }
      .controls button .button-text {
        white-space: nowrap;
        opacity: 0;
        max-width: 0;
        overflow: hidden;
        margin-left: 0;
        transition: opacity 0.35s ease, max-width 0.35s ease,
          margin-left 0.35s ease;
        flex: 0 0 auto;
      }
      .controls button:hover {
        width: 165px;
        border-radius: 100px;
        justify-content: flex-start;
        padding-left: 15px;
      }
      .controls button:hover svg {
        margin-right: 10px;
      }
      .controls button:hover .button-text {
        opacity: 1;
        max-width: 140px;
        margin-left: 0;
      }
      #sendButton {
        background-color: #25d365;
      }
      #sendButton:hover {
        background-color: #1da851;
      }
      #aiButton {
        background-color: #007aff;
      }
      #aiButton:hover {
        background-color: #0056b3;
        width: 180px;
      } /*--- close.button.css ---*/
      .header-content {
        display: flex;
        justify-content: space-between;
      }
      .header-content p {
        margin: 0px;
        font-size: 1.2rem;
        align-self: center;
        font-weight: 450;
      }
      @media (max-width: 480px) {
        .header-content {
          flex-direction: column;
        }
      }
    </style>
  </head>
  <body>
    <div class="header">
      <button id="btnClose" class="close-button" aria-label="Cerrar">
        &times;
      </button>
      <div class="header-content">
        <h2 class="title">Revisa y env√≠a a:&nbsp;</h2>
        <p>Luis</p>
      </div>
    </div>
    <textarea id="textEditor" aria-label="Editor de texto"></textarea>
    <div class="controls">
      <button id="aiButton" title="Mejorar con IA">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="currentColor"
        >
          <path
            d="M21.928 11.607c-.202-.488-.635-.605-.928-.633V8c0-1.103-.897-2-2-2h-6V4.61c.305-.274.5-.668.5-1.11a1.5 1.5 0 0 0-3 0c0 .442.195.836.5 1.11V6H5c-1.103 0-2 .897-2 2v2.997l-.082.006A1 1 0 0 0 1.99 12v2a1 1 0 0 0 1 1H3v5c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5a1 1 0 0 0 1-1v-1.938a1.006 1.006 0 0 0-.072-.455zM5 20V8h14l.001 3.996L19 12v2l.001.005.001 5.995H5z"
          />
          <ellipse cx="8.5" cy="12" rx="1.5" ry="2" />
          <ellipse cx="15.5" cy="12" rx="1.5" ry="2" />
          <path d="M8 16h8v2H8z" />
        </svg>
        <span class="button-text">Mejorar con IA</span>
      </button>
      <button id="sendButton" title="Enviar">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="currentColor"
        >
          <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" />
        </svg>
        <span class="button-text">Enviar</span>
      </button>
    </div>
    <!-- Test JS -->
    <!-- <script type='module' src='../../../utils/filemaker.js'></script> <script type='module' src='../js/index.js'></script> -->
    <script>
      /* import { execFileMaker } from '../../../../utils/execFileMaker.js'; */ document.addEventListener(
        "DOMContentLoaded",
        () => {
          /* --- DOM Elements ---*/ const textEditor =
            document.getElementById("textEditor");
          const sendButton = document.getElementById("sendButton");
          const aiButton = document.getElementById("aiButton");
          const btnClose = document.getElementById("btnClose");
          /* --- Data ---*/ textEditor.value = ``;
          let data = {};
          /* --- Data Example Test ---*/ /** textEditor.value = `hello, this is a sample text`; */ /* --- Functions ---*/ /*--- execFileMaker.js ---*/ /** * Execute FileMaker Script * @param {object} data - Data (JSON) to use in FileMaker Script * @param {string} scriptName - Name of the script from FileMaker */ function execFileMaker(
            data,
            scriptName
          ) {
            if (typeof FileMaker !== "undefined") {
              FileMaker.PerformScript(scriptName, JSON.stringify(data));
            } else {
              alert("FileMaker no definido");
            }
          }
          /** * Createe JSON to decide how to prooced (close WebViewer or open WhatsApp Chat) * @param {string} callType - Type action */ function createJSONData(
            callType,
            message
          ) {
            /* --- Data Example Test ---*/ /* data = { whatsNumber: '5656998800', classRecordIDoU: '9000', isWebApp: 'APP', callType: callType, className: 'Cliente' }; */ data =
              {
                contactoNombre: " Luis",
                contactoIDU: " ",
                whatsNumber: " 525566829484",
                classRecordIDoU: "949",
                isWebApp: " WEB",
                callType: callType,
                className: "Cliente",
                message: message,
              };
            if (callType === "closeDiv")
              execFileMaker(
                data,
                "api.WhatsApp ## msg.selectTypeAndPrep[js]|v0.25.2"
              );
            else
              setTimeout(() => {
                execFileMaker(
                  data,
                  "api.WhatsApp ## msg.selectTypeAndPrep[js]|v0.25.2"
                );
              }, 1500);
          }
          btnClose.addEventListener("click", () => {
            createJSONData("closeDiv");
          });
          /* Send Button: Execute FileMaker script to open WhatsApp */ sendButton.addEventListener(
            "click",
            () => {
              createJSONData("OpenWhatsApp", textEditor.value);
            }
          );
          /* AI Improve Button: Execute FileMaker script to improve message */ aiButton.addEventListener(
            "click",
            () => {
              createJSONData("ImproveWithAI", textEditor.value);
            }
          );
        }
      );
    </script>
  </body>
</html>
